# Matcap Maker v3 ライブラリ - Future Roadmap

このドキュメントは、Matcap Maker v3の将来的な機能拡張計画とアイディアをまとめたものです。

## 🛠 Core Features (機能強化)

### 1. Undo/Redo システム
- **現状**: 操作を取り消す手段がない。
- **計画**: Command Patternを導入し、レイヤーの追加・削除・パラメータ変更をスタック管理して、Ctrl+Z / Ctrl+Y で操作を行き来できるようにする。

### 2. カスタムメッシュ・プレビュー
- **現状**: 球体 (Sphere) のみでプレビュー。
- **計画**: `.obj` や `.fbx` などのユーザーモデルをインポートし、実際のモデル上でMatcapの見た目を確認できるようにする。

### 3. マスキングシステム
- **現状**: レイヤーは全体に適用またはBlend Modeのみ。
- **計画**: 
    - 各レイヤーに「マスク」チャンネルを追加。
    - FresnelやNoise、外部画像をマスクとして使用し、特定部分にのみレイヤー効果を適用可能にする（例：リムライト部分にだけノイズを乗せるなど）。

### 4. グラデーションレイヤー & カーブ編集
- **現状**: 単色またはライト計算のみ。
- **計画**:
    - 線形・円形グラデーションレイヤーの追加。
    - ライトのカゲの落ち方をカーブ（Color Ramp）で制御できる機能。

### 5. ポストプロセスエフェクト (Global Effects)
- **現状**: レイヤー合成のみ。
- **計画**: 最終的なレンダリング結果に対して全体にかけるエフェクト。
    - **Blur / Sharpen**: 全体をぼかす/くっきりさせる。
    - **Chromatic Aberration**: 色収差を追加してアナログ感を出す。
    - **Grain**: フィルム粒子ノイズ。

## ⚙ System & Architecture (システム)

### 1. HDR (High Dynamic Range) サポート
- **現状**: 8-bit (0-255) のみ。
- **計画**: 内部計算を 16-bit float (EXR/HDR) で行い、Unity/Unreal などのハイエンド用途に対応する。`.exr` エクスポートの実装。

### 2. プラグイン・スクリプト API
- **現状**: ソースコード変更が必要。
- **計画**: Pythonスクリプトを `plugins/` フォルダに入れるだけで新しいレイヤータイプを追加できる仕組み。

### 3. パフォーマンス最適化
- **現状**: レイヤーごとに描画コールが発生。レイヤー数が増えると重くなる可能性。
- **計画**: 複数のレイヤーを1つのシェーダーに動的にコンパイルしてまとめる (Uber Shader化) か、Compute Shaderによる合成への移行。

## 🎨 UI/UX Improvements (使い勝手)

### 1. レイヤーサムネイル
- レイヤーリストに現在のレイヤーの見た目を小さなアイコンで表示する。

### 2. プリセットライブラリ
- よく使う「金属」「プラスチック」「肌」などのレイヤー構成をプリセットとして保存・読み込みできるパネル。

### 3. ドラッグ＆ドロップ
- 画像ファイルをウィンドウにドラッグ＆ドロップしてImage Layerを作成。
- プロジェクトファイルをドラッグ＆ドロップして開く。
